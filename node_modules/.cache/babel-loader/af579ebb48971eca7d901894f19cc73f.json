{"ast":null,"code":"\"use strict\";\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Chart = void 0;\n\nconst d3_shape_1 = require(\"d3-shape\");\n\nconst d3_format_1 = require(\"d3-format\");\n\nconst d3_scale_1 = require(\"d3-scale\");\n\nconst d3_axis_1 = require(\"d3-axis\");\n\nconst d3_zoom_1 = require(\"d3-zoom\"); // @ts-ignore\n\n\nconst d3_selection_1 = require(\"d3-selection\");\n\nconst d3_interpolate_1 = require(\"d3-interpolate\");\n\nconst events_1 = __importDefault(require(\"events\"));\n\nconst annotations_1 = __importDefault(require(\"./helpers/annotations\"));\n\nconst tip_1 = __importDefault(require(\"./tip\"));\n\nconst helpers_1 = __importDefault(require(\"./helpers\"));\n\nconst datum_defaults_1 = __importDefault(require(\"./datum-defaults\"));\n\nconst globals_1 = __importDefault(require(\"./globals\"));\n\nconst graphTypes = __importStar(require(\"./graph-types\"));\n\nconst $eval = __importStar(require(\"./helpers/eval\"));\n\nrequire('./polyfills');\n\nconst d3Scale = {\n  linear: d3_scale_1.scaleLinear,\n  log: d3_scale_1.scaleLog\n};\n/**\n * An instance can subscribe to any of the following events by doing `instance.on([eventName], callback)`,\n * events can be triggered by doing `instance.emit([eventName][, params])`\n *\n * - `mouseover` fired whenever the mouse is over the canvas\n * - `mousemove` fired whenever the mouse is moved inside the canvas, callback params: a single object `{x: number, y: number}` (in canvas space\n coordinates)\n * - `mouseout` fired whenever the mouse is moved outside the canvas\n * - `before:draw` fired before drawing all the graphs\n * - `after:draw` fired after drawing all the graphs\n * - `zoom:scaleUpdate` fired whenever the scale of another graph is updated, callback params `xScale`, `yScale`\n (x-scale and y-scale of another graph whose scales were updated)\n * - `tip:update` fired whenever the tip position is updated, callback params `{x, y, index}` (in canvas\n space coordinates, `index` is the index of the graph where the tip is on top of)\n * - `eval` fired whenever the sampler evaluates a function, callback params `data` (an array of segment/points),\n `index` (the index of datum in the `data` array), `isHelper` (true if the data is created for a helper e.g.\n for the derivative/secant)\n *\n * The following events are dispatched to all the linked graphs\n *\n * - `all:mouseover` same as `mouseover` but it's dispatched in each linked graph\n * - `all:mousemove` same as `mousemove` but it's dispatched in each linked graph\n * - `all:mouseout` same as `mouseout` but it's dispatched in each linked graph\n * - `all:zoom:scaleUpdate` same as `zoom:scaleUpdate` but it's dispatched in each linked graph\n * - `all:zoom` fired whenever there's scaling/translation on the graph, dispatched on all the linked graphs\n */\n\nclass Chart extends events_1.default.EventEmitter {\n  constructor(options) {\n    super();\n    const n = Math.random();\n    const letter = String.fromCharCode(Math.floor(n * 26) + 97);\n    this.options = options;\n    this.id = letter + n.toString(16).substr(2);\n    this.options.id = this.id;\n    this.markerId = this.id + '-marker';\n    Chart.cache[this.id] = this;\n    this.linkedGraphs = [this];\n    this.meta = {};\n    this.setUpEventListeners();\n  }\n  /**\n   * Rebuilds the entire graph from scratch recomputing\n   *\n   * - the inner width/height\n   * - scales/axes\n   *\n   * After this is done it does a complete redraw of all the datums,\n   * if only the datums need to be redrawn call `instance.draw()` instead\n   *\n   * @returns {Chart}\n   */\n\n\n  build() {\n    this.internalVars();\n    this.drawGraphWrapper();\n    return this;\n  }\n\n  getDraggableNode() {\n    return d3_selection_1.select(this.options.target).select('.zoom-and-drag').node();\n  }\n  /**\n   * The draggable container won't change across different instances of Chart,\n   * therefore multiple instances will share the draggable container, to avoid dispatching\n   * the event from the old instance grab it in runtime with this function\n   */\n\n\n  getEmitInstance() {\n    let cachedInstance = this;\n    const cachedNode = this.getDraggableNode();\n\n    if (cachedNode) {\n      cachedInstance = cachedNode.instance;\n    }\n\n    return cachedInstance;\n  }\n\n  internalVars() {\n    const self = this;\n    const margin = this.meta.margin = {\n      left: 40,\n      right: 20,\n      top: 20,\n      bottom: 20\n    }; // if there's a title make the top margin bigger\n\n    if (this.options.title) {\n      this.meta.margin.top = 40;\n    } // inner width/height\n\n\n    this.meta.width = (this.options.width || globals_1.default.DEFAULT_WIDTH) - margin.left - margin.right;\n    this.meta.height = (this.options.height || globals_1.default.DEFAULT_HEIGHT) - margin.top - margin.bottom;\n    this.initializeAxes();\n  }\n\n  initializeAxes() {\n    const self = this;\n    const integerFormat = d3_format_1.format('~s');\n    const floatFormat = d3_format_1.format('~e');\n\n    function formatter(d) {\n      // take only the decimal part of the number\n      const frac = Math.abs(d) - Math.floor(Math.abs(d));\n\n      if (frac > 0) {\n        return d.toString();\n      } else {\n        return integerFormat(d);\n      }\n    }\n\n    function computeYScale(xScale) {\n      // assumes that xScale is a linear scale\n      const xDiff = xScale[1] - xScale[0];\n      return self.meta.height * xDiff / self.meta.width;\n    }\n\n    this.options.xAxis = this.options.xAxis || {};\n    this.options.xAxis.type = this.options.xAxis.type || 'linear';\n    this.options.yAxis = this.options.yAxis || {};\n    this.options.yAxis.type = this.options.yAxis.type || 'linear';\n\n    const xDomain = this.meta.xDomain = function (axis) {\n      if (axis.domain) {\n        return axis.domain;\n      }\n\n      if (axis.type === 'linear') {\n        const xLimit = 12;\n        return [-xLimit / 2, xLimit / 2];\n      } else if (axis.type === 'log') {\n        return [1, 10];\n      }\n\n      throw Error('axis type ' + axis.type + ' unsupported');\n    }(this.options.xAxis);\n\n    const yDomain = this.meta.yDomain = function (axis) {\n      if (axis.domain) {\n        return axis.domain;\n      }\n\n      const yLimit = computeYScale(xDomain);\n\n      if (axis.type === 'linear') {\n        return [-yLimit / 2, yLimit / 2];\n      } else if (axis.type === 'log') {\n        return [1, 10];\n      }\n\n      throw Error('axis type ' + axis.type + ' unsupported');\n    }(this.options.yAxis);\n\n    if (!this.meta.xScale) {\n      this.meta.xScale = d3Scale[this.options.xAxis.type]();\n    }\n\n    this.meta.xScale.domain(xDomain).range(this.options.xAxis.invert ? [this.meta.width, 0] : [0, this.meta.width]);\n\n    if (!this.meta.yScale) {\n      this.meta.yScale = d3Scale[this.options.yAxis.type]();\n    }\n\n    this.meta.yScale.domain(yDomain).range(this.options.yAxis.invert ? [0, this.meta.height] : [this.meta.height, 0]);\n\n    if (!this.meta.xAxis) {\n      this.meta.xAxis = d3_axis_1.axisBottom(this.meta.xScale);\n    }\n\n    this.meta.xAxis.tickSize(this.options.grid ? -this.meta.height : 0).tickFormat(formatter);\n\n    if (!this.meta.yAxis) {\n      this.meta.yAxis = d3_axis_1.axisLeft(this.meta.yScale);\n    }\n\n    this.meta.yAxis.tickSize(this.options.grid ? -this.meta.width : 0).tickFormat(formatter);\n    this.line = d3_shape_1.line().x(function (d) {\n      return self.meta.xScale(d[0]);\n    }).y(function (d) {\n      return self.meta.yScale(d[1]);\n    });\n  }\n\n  drawGraphWrapper() {\n    const root = this.root = d3_selection_1.select(this.options.target).selectAll('svg').data([this.options]); // enter\n\n    this.root.enter = root.enter().append('svg').attr('class', 'function-plot').attr('font-size', this.getFontSize()); // enter + update\n\n    root.merge(this.root.enter).attr('width', this.meta.width + this.meta.margin.left + this.meta.margin.right).attr('height', this.meta.height + this.meta.margin.top + this.meta.margin.bottom);\n    this.buildTitle();\n    this.buildLegend();\n    this.buildCanvas();\n    this.buildClip();\n    this.buildAxis();\n    this.buildAxisLabel(); // draw each datum after the wrapper was set up\n\n    this.draw(); // helper to detect the closest fn to the cursor's current abscissa\n\n    const tip = this.tip = tip_1.default(Object.assign(this.options.tip || {}, {\n      owner: this\n    }));\n    this.canvas.merge(this.canvas.enter).call(tip);\n    this.buildZoomHelper();\n    this.setUpPlugins();\n  }\n\n  buildTitle() {\n    // join\n    const selection = this.root.merge(this.root.enter).selectAll('text.title').data(function (d) {\n      return [d.title].filter(Boolean);\n    }); // enter\n\n    const selectionEnter = selection.enter().append('text');\n    selectionEnter.merge(selection).attr('class', 'title').attr('y', this.meta.margin.top / 2).attr('x', this.meta.margin.left + this.meta.width / 2).attr('font-size', 25).attr('text-anchor', 'middle').attr('alignment-baseline', 'middle').text(this.options.title); // exit\n\n    selection.exit().remove();\n  }\n\n  buildLegend() {\n    // enter\n    this.root.enter.append('text').attr('class', 'top-right-legend').attr('text-anchor', 'end'); // update + enter\n\n    this.root.merge(this.root.enter).select('.top-right-legend').attr('y', this.meta.margin.top / 2).attr('x', this.meta.width + this.meta.margin.left);\n  }\n\n  buildCanvas() {\n    // enter\n    const canvas = this.canvas = this.root.merge(this.root.enter).selectAll('.canvas').data(function (d) {\n      return [d];\n    });\n    this.canvas.enter = canvas.enter().append('g').attr('class', 'canvas'); // enter + update\n  }\n\n  buildClip() {\n    // (so that the functions don't overflow on zoom or drag)\n    const id = this.id;\n    const defs = this.canvas.enter.append('defs');\n    defs.append('clipPath').attr('id', 'function-plot-clip-' + id).append('rect').attr('class', 'clip static-clip'); // enter + update\n\n    this.canvas.merge(this.canvas.enter).selectAll('.clip').attr('width', this.meta.width).attr('height', this.meta.height); // marker clip (for vectors)\n\n    defs.append('clipPath').append('marker').attr('id', this.markerId).attr('viewBox', '0 -5 10 10').attr('refX', 10).attr('markerWidth', 5).attr('markerHeight', 5).attr('orient', 'auto').append('svg:path').attr('d', 'M0,-5L10,0L0,5L0,0').attr('stroke-width', '0px').attr('fill-opacity', 1).attr('fill', '#777');\n  }\n\n  buildAxis() {\n    // axis creation\n    const canvasEnter = this.canvas.enter;\n    canvasEnter.append('g').attr('class', 'x axis');\n    canvasEnter.append('g').attr('class', 'y axis'); // update\n\n    this.canvas.merge(this.canvas.enter).select('.x.axis').attr('transform', 'translate(0,' + this.meta.height + ')').call(this.meta.xAxis);\n    this.canvas.merge(this.canvas.enter).select('.y.axis').call(this.meta.yAxis);\n  }\n\n  buildAxisLabel() {\n    // axis labeling\n    const canvas = this.canvas;\n    const xLabel = canvas.merge(canvas.enter).selectAll('text.x.axis-label').data(function (d) {\n      return [d.xAxis.label].filter(Boolean);\n    });\n    const xLabelEnter = xLabel.enter().append('text').attr('class', 'x axis-label').attr('text-anchor', 'end');\n    xLabel.merge(xLabelEnter).attr('x', this.meta.width).attr('y', this.meta.height - 6).text(function (d) {\n      return d;\n    });\n    xLabel.exit().remove();\n    const yLabel = canvas.merge(canvas.enter).selectAll('text.y.axis-label').data(function (d) {\n      return [d.yAxis.label].filter(Boolean);\n    });\n    const yLabelEnter = yLabel.enter().append('text').attr('class', 'y axis-label').attr('y', 6).attr('dy', '.75em').attr('text-anchor', 'end').attr('transform', 'rotate(-90)');\n    yLabel.merge(yLabelEnter).text(function (d) {\n      return d;\n    });\n    yLabel.exit().remove();\n  }\n  /**\n   * @private\n   *\n   * Draws each of the datums stored in data.options, to do a full\n   * redraw call `instance.draw()`\n   */\n\n\n  buildContent() {\n    const self = this;\n    const canvas = this.canvas;\n    canvas.merge(canvas.enter).attr('transform', 'translate(' + this.meta.margin.left + ',' + this.meta.margin.top + ')');\n    const content = this.content = canvas.merge(canvas.enter).selectAll(':scope > g.content').data(function (d) {\n      return [d];\n    }); // g tag clipped to hold the data\n\n    const contentEnter = content.enter().append('g').attr('clip-path', 'url(#function-plot-clip-' + this.id + ')').attr('class', 'content'); // helper line, x = 0\n\n    if (this.options.xAxis.type === 'linear') {\n      const yOrigin = content.merge(contentEnter).selectAll(':scope > path.y.origin').data([[[0, this.meta.yScale.domain()[0]], [0, this.meta.yScale.domain()[1]]]]);\n      const yOriginEnter = yOrigin.enter().append('path').attr('class', 'y origin').attr('stroke', 'black').attr('opacity', 0.2);\n      yOrigin.merge(yOriginEnter).attr('d', this.line);\n    } // helper line y = 0\n\n\n    if (this.options.yAxis.type === 'linear') {\n      const xOrigin = content.merge(contentEnter).selectAll(':scope > path.x.origin').data([[[this.meta.xScale.domain()[0], 0], [this.meta.xScale.domain()[1], 0]]]);\n      const xOriginEnter = xOrigin.enter().append('path').attr('class', 'x origin').attr('stroke', 'black').attr('opacity', 0.2);\n      xOrigin.merge(xOriginEnter).attr('d', this.line);\n    } // annotations\n\n\n    content.merge(contentEnter).call(annotations_1.default({\n      owner: self\n    })); // content construction\n    // - join options.data to <g class='graph'> elements\n    // - for each datum determine the sampler to use\n\n    const graphs = content.merge(contentEnter).selectAll(':scope > g.graph').data(d => d.data.map(datum_defaults_1.default)); // enter\n\n    const graphsEnter = graphs.enter().append('g').attr('class', 'graph'); // enter + update\n\n    graphs.merge(graphsEnter).each(function (d, index) {\n      // additional options needed in the graph-types/helpers\n      d.index = index;\n      const selection = d3_selection_1.select(this);\n      selection.call(graphTypes[d.graphType](self));\n      selection.call(helpers_1.default(self));\n    });\n  }\n\n  buildZoomHelper() {\n    // dummy rect (detects the zoom + drag)\n    const self = this;\n\n    if (!this.meta.zoomBehavior) {\n      this.meta.zoomBehavior = d3_zoom_1.zoom().on('zoom', function onZoom(ev) {\n        self.getEmitInstance().emit('all:zoom', ev);\n      }); // the zoom behavior must work with a copy of the scale, the zoom behavior has its own state and assumes\n      // that its updating the original scale!\n      // things that failed when I tried rescaleX(self.meta.xScale), the state of self.meta.xScale was a multiplied\n      // for zoom/mousemove operations\n      //\n      // this copy should only be created once when the application starts\n\n      self.meta.zoomBehavior.xScale = self.meta.xScale.copy();\n      self.meta.zoomBehavior.yScale = self.meta.yScale.copy();\n    } // in the case where the original scale domains were updated (because of a change in the size of the canvas)\n    // update the range only but not the domain, the domain is going to be updated\n\n\n    self.meta.zoomBehavior.xScale.range(self.meta.xScale.range());\n    self.meta.zoomBehavior.yScale.range(self.meta.yScale.range()); // enter\n\n    this.canvas.enter.append('rect').call(this.meta.zoomBehavior).attr('class', 'zoom-and-drag').style('fill', 'none').style('pointer-events', 'all').on('mouseover', function (event) {\n      self.getEmitInstance().emit('all:mouseover', event);\n    }).on('mouseout', function (event) {\n      self.getEmitInstance().emit('all:mouseout', event);\n    }).on('mousemove', function (event) {\n      self.getEmitInstance().emit('all:mousemove', event);\n    }); // update + enter\n\n    this.draggable = this.canvas.merge(this.canvas.enter).select('.zoom-and-drag').call(selection => {\n      if (selection.node()) {\n        // store the instance for the next run\n        selection.node().instance = self;\n      }\n    }).attr('width', this.meta.width).attr('height', this.meta.height);\n  }\n\n  setUpPlugins() {\n    const plugins = this.options.plugins || [];\n    const self = this;\n    plugins.forEach(function (plugin) {\n      plugin(self);\n    });\n  }\n\n  addLink() {\n    for (let i = 0; i < arguments.length; i += 1) {\n      this.linkedGraphs.push(arguments[i]);\n    }\n  }\n\n  updateAxes() {\n    const instance = this;\n    const canvas = instance.canvas.merge(instance.canvas.enter);\n    canvas.select('.x.axis').call(instance.meta.xAxis);\n    canvas.select('.y.axis').call(instance.meta.yAxis); // updates the style of the axes\n\n    canvas.selectAll('.axis path, .axis line').attr('fill', 'none').attr('stroke', 'black').attr('shape-rendering', 'crispedges').attr('opacity', 0.1);\n  }\n\n  syncOptions() {\n    // update the original options yDomain and xDomain, this is done so that next calls to functionPlot()\n    // with the same object preserve some of the computed state\n    this.options.xAxis.domain = this.meta.xScale.domain();\n    this.options.yAxis.domain = this.meta.yScale.domain();\n  }\n\n  getFontSize() {\n    return Math.max(Math.max(this.meta.width, this.meta.height) / 50, 8);\n  }\n\n  draw() {\n    const instance = this;\n    instance.emit('before:draw');\n    instance.syncOptions();\n    instance.updateAxes();\n    instance.buildContent();\n    instance.emit('after:draw');\n  }\n\n  setUpEventListeners() {\n    const self = this; // before setting up the listeners, remove any listeners set on the previous instance, this happens because\n    // the draggable container is shared across instances\n\n    const prevInstance = this.getEmitInstance();\n\n    if (prevInstance) {\n      prevInstance.removeAllListeners();\n    }\n\n    const events = {\n      mousemove: function (coordinates) {\n        self.tip.move(coordinates);\n      },\n      mouseover: function () {\n        self.tip.show();\n      },\n      mouseout: function () {\n        self.tip.hide();\n      },\n      zoom: function zoom(_ref) {\n        let {\n          transform\n        } = _ref;\n        // disable zoom\n        if (self.options.disableZoom) return;\n        const xScaleClone = transform.rescaleX(self.meta.zoomBehavior.xScale).interpolate(d3_interpolate_1.interpolateRound);\n        const yScaleClone = transform.rescaleY(self.meta.zoomBehavior.yScale).interpolate(d3_interpolate_1.interpolateRound); // update the scales's metadata\n        // NOTE: setting self.meta.xScale = self.meta.zoomBehavior.xScale creates artifacts and weird lines\n\n        self.meta.xScale.domain(xScaleClone.domain()).range(xScaleClone.range());\n        self.meta.yScale.domain(yScaleClone.domain()).range(yScaleClone.range());\n      },\n      'tip:update': function (_ref2) {\n        let {\n          x,\n          y,\n          index\n        } = _ref2;\n        const meta = self.root.merge(self.root.enter).datum().data[index];\n        const title = meta.title || '';\n\n        const format = meta.renderer || function (x, y) {\n          return x.toFixed(3) + ', ' + y.toFixed(3);\n        };\n\n        const text = [];\n        title && text.push(title);\n        text.push(format(x, y));\n        self.root.select('.top-right-legend').attr('fill', globals_1.default.COLORS[index]).text(text.join(' '));\n      }\n    }; // all represents events that can be propagated to all the instances (including this one)\n\n    const all = {\n      mousemove: function (event) {\n        const mouse = d3_selection_1.pointer(event, self.draggable.node());\n        const coordinates = {\n          x: self.meta.xScale.invert(mouse[0]),\n          y: self.meta.yScale.invert(mouse[1])\n        };\n        self.linkedGraphs.forEach(function (graph) {\n          graph.emit('before:mousemove', coordinates);\n          graph.emit('mousemove', coordinates);\n        });\n      },\n      zoom: function (event) {\n        self.linkedGraphs.forEach(function (graph) {\n          // hack to synchronize the zoom state across all the instances\n          graph.draggable.node().__zoom = self.draggable.node().__zoom;\n          graph.emit('zoom', event);\n          graph.draw();\n        }); // emit the position of the mouse to all the registered graphs\n\n        self.emit('all:mousemove', event);\n      }\n    };\n    Object.keys(events).forEach(function (e) {\n      // create an event for each event existing on `events` in the form 'all:' event\n      // e.g. all:mouseover all:mouseout\n      // the objective is that all the linked graphs receive the same event as the current graph\n      // @ts-ignore\n      !all[e] && self.on('all:' + e, function () {\n        const args = Array.prototype.slice.call(arguments);\n        self.linkedGraphs.forEach(function (graph) {\n          const localArgs = args.slice();\n          localArgs.unshift(e);\n          graph.emit.apply(graph, localArgs);\n        });\n      }); // @ts-ignore\n\n      self.on(e, events[e]);\n    });\n    Object.keys(all).forEach(function (e) {\n      // @ts-ignore\n      self.on('all:' + e, all[e]);\n    });\n  }\n\n}\n\nexports.Chart = Chart;\nChart.cache = {};\n\nfunction functionPlot() {\n  let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {\n    target: null\n  };\n  options.data = options.data || [];\n  let instance = Chart.cache[options.id];\n\n  if (!instance) {\n    instance = new Chart(options);\n  }\n\n  return instance.build();\n}\n\nfunctionPlot.globals = globals_1.default;\nfunctionPlot.$eval = $eval;\nfunctionPlot.graphTypes = graphTypes;\nexports.default = functionPlot;","map":{"version":3,"mappings":"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","names":["require","d3Scale","linear","d3_scale_1","log","Chart","events_1","EventEmitter","constructor","options","n","Math","random","letter","String","fromCharCode","floor","id","toString","substr","markerId","cache","linkedGraphs","meta","setUpEventListeners","build","internalVars","drawGraphWrapper","getDraggableNode","d3_selection_1","target","select","node","getEmitInstance","cachedInstance","cachedNode","instance","self","margin","left","right","top","bottom","title","width","globals_1","DEFAULT_WIDTH","height","DEFAULT_HEIGHT","initializeAxes","integerFormat","d3_format_1","floatFormat","formatter","d","frac","abs","computeYScale","xScale","xDiff","xAxis","type","yAxis","xDomain","axis","domain","xLimit","Error","yDomain","yLimit","range","invert","yScale","d3_axis_1","tickSize","grid","tickFormat","line","d3_shape_1","x","y","root","selectAll","data","enter","append","attr","getFontSize","merge","buildTitle","buildLegend","buildCanvas","buildClip","buildAxis","buildAxisLabel","draw","tip","tip_1","Object","assign","owner","canvas","call","buildZoomHelper","setUpPlugins","selection","filter","Boolean","selectionEnter","text","exit","remove","defs","canvasEnter","xLabel","label","xLabelEnter","yLabel","yLabelEnter","buildContent","content","contentEnter","yOrigin","yOriginEnter","xOrigin","xOriginEnter","annotations_1","graphs","map","datum_defaults_1","graphsEnter","each","index","graphTypes","graphType","helpers_1","zoomBehavior","d3_zoom_1","on","onZoom","ev","emit","copy","style","event","draggable","plugins","forEach","plugin","addLink","i","arguments","length","push","updateAxes","syncOptions","max","prevInstance","removeAllListeners","events","mousemove","coordinates","move","mouseover","show","mouseout","hide","zoom","transform","disableZoom","xScaleClone","rescaleX","interpolate","d3_interpolate_1","yScaleClone","rescaleY","datum","format","renderer","toFixed","COLORS","join","all","mouse","graph","__zoom","keys","e","args","Array","prototype","slice","localArgs","unshift","apply","exports","functionPlot","globals","$eval"],"sources":["../src/index.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}