{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst d3_shape_1 = require(\"d3-shape\");\n\nconst d3_selection_1 = require(\"d3-selection\");\n\nfunction annotations(options) {\n  const xScale = options.owner.meta.xScale;\n  const yScale = options.owner.meta.yScale;\n  const line = d3_shape_1.line().x(function (d) {\n    return d[0];\n  }).y(function (d) {\n    return d[1];\n  });\n  return function (parentSelection) {\n    parentSelection.each(function () {\n      // join\n      const current = d3_selection_1.select(this);\n      const selection = current.selectAll('g.annotations').data(function (d) {\n        return d.annotations || [];\n      }); // enter\n\n      const enter = selection.enter().append('g').attr('class', 'annotations'); // enter + update\n      // - path\n\n      const yRange = yScale.range();\n      const xRange = xScale.range();\n      const path = selection.merge(enter).selectAll('path').data(function (d) {\n        if ('x' in d) {\n          return [[[0, yRange[0]], [0, yRange[1]]]];\n        } else {\n          return [[[xRange[0], 0], [xRange[1], 0]]];\n        }\n      });\n      path.enter().append('path').attr('stroke', '#eee').attr('d', line);\n      path.exit().remove(); // enter + update\n      // - text\n\n      const text = selection.merge(enter).selectAll('text').data(function (d) {\n        return [{\n          text: d.text || '',\n          hasX: 'x' in d\n        }];\n      });\n      text.enter().append('text').attr('y', function (d) {\n        return d.hasX ? 3 : 0;\n      }).attr('x', function (d) {\n        return d.hasX ? 0 : 3;\n      }).attr('dy', function (d) {\n        return d.hasX ? 5 : -5;\n      }).attr('text-anchor', function (d) {\n        return d.hasX ? 'end' : '';\n      }).attr('transform', function (d) {\n        return d.hasX ? 'rotate(-90)' : '';\n      }).text(function (d) {\n        return d.text;\n      });\n      text.exit().remove(); // enter + update\n      // move group\n\n      selection.merge(enter).attr('transform', function (d) {\n        if ('x' in d) {\n          return 'translate(' + xScale(d.x) + ', 0)';\n        } else {\n          return 'translate(0, ' + yScale(d.y) + ')';\n        }\n      }); // exit\n\n      selection.exit().remove();\n    });\n  };\n}\n\nexports.default = annotations;","map":{"version":3,"mappings":"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","names":["annotations","options","xScale","owner","meta","yScale","line","d3_shape_1","x","d","y","parentSelection","each","current","d3_selection_1","selection","selectAll","data","enter","append","attr","yRange","range","xRange","path","merge","exit","remove","text","hasX","exports"],"sources":["../../src/helpers/annotations.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}