{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nconst globals_1 = __importDefault(require(\"./globals\"));\n\nconst samplers_1 = require(\"./samplers\");\n\nconst evalTypeFn = {\n  interval: samplers_1.interval,\n  builtIn: samplers_1.builtIn\n};\n/**\n * Computes the endpoints x_lo, x_hi of the range\n * from which the sampler will take samples\n *\n * @param {Object} scale\n * @param {Object} d An item from `data`\n * @returns {Array}\n */\n\nfunction computeEndpoints(scale, d) {\n  const range = d.range || [-Infinity, Infinity];\n  const start = Math.max(scale.domain()[0], range[0]);\n  const end = Math.min(scale.domain()[1], range[1]);\n  return [start, end];\n}\n/**\n * Decides which sampler function to call based on the options\n * of `data`\n *\n * @param {Object} chart Chart instance which is orchestrating this sampling operation\n * @param {Object} d a.k.a a single item from `data`\n * @returns {Array}\n */\n\n\nfunction evaluate(chart, d) {\n  const range = computeEndpoints(chart.meta.xScale, d);\n  const evalFn = evalTypeFn[d.sampler];\n  const nSamples = d.nSamples || Math.min(globals_1.default.MAX_ITERATIONS, globals_1.default.DEFAULT_ITERATIONS || chart.meta.width * 2);\n  const data = evalFn(chart, d, range, nSamples); // NOTE: it's impossible to listen for the first eval event\n  // as the event is already fired when a listener is attached\n\n  chart.emit('eval', data, d.index, d.isHelper);\n  return data;\n}\n\nexports.default = evaluate;","map":{"version":3,"mappings":";;;;;;;;;;;;AAAA;;AACA;;AAKA,MAAMA,UAAU,GAAG;EACjBC,QAAQ,EAARC,mBADiB;EAEjBC,OAAO,EAAPD;AAFiB,CAAnB;AAKA;;;;;;;;;AAQA,SAASE,gBAAT,CAA2BC,KAA3B,EAAuCC,CAAvC,EAA6C;EAC3C,MAAMC,KAAK,GAAGD,CAAC,CAACC,KAAF,IAAW,CAAC,CAACC,QAAF,EAAYA,QAAZ,CAAzB;EACA,MAAMC,KAAK,GAAGC,IAAI,CAACC,GAAL,CAASN,KAAK,CAACO,MAAN,GAAe,CAAf,CAAT,EAA4BL,KAAK,CAAC,CAAD,CAAjC,CAAd;EACA,MAAMM,GAAG,GAAGH,IAAI,CAACI,GAAL,CAAST,KAAK,CAACO,MAAN,GAAe,CAAf,CAAT,EAA4BL,KAAK,CAAC,CAAD,CAAjC,CAAZ;EACA,OAAO,CAACE,KAAD,EAAQI,GAAR,CAAP;AACD;AAED;;;;;;;;;;AAQA,SAASE,QAAT,CAAmBC,KAAnB,EAAiCV,CAAjC,EAAqD;EACnD,MAAMC,KAAK,GAAGH,gBAAgB,CAACY,KAAK,CAACC,IAAN,CAAWC,MAAZ,EAAoBZ,CAApB,CAA9B;EACA,MAAMa,MAAM,GAAGnB,UAAU,CAACM,CAAC,CAACc,OAAH,CAAzB;EACA,MAAMC,QAAQ,GAAGf,CAAC,CAACe,QAAF,IAAcX,IAAI,CAACI,GAAL,CAC7BQ,kBAAQC,cADqB,EAE7BD,kBAAQE,kBAAR,IAA+BR,KAAK,CAACC,IAAN,CAAWQ,KAAX,GAAmB,CAFrB,CAA/B;EAKA,MAAMC,IAAI,GAAGP,MAAM,CAACH,KAAD,EAAQV,CAAR,EAAWC,KAAX,EAAkBc,QAAlB,CAAnB,CARmD,CASnD;EACA;;EACAL,KAAK,CAACW,IAAN,CAAW,MAAX,EAAmBD,IAAnB,EAAyBpB,CAAC,CAACsB,KAA3B,EAAkCtB,CAAC,CAACuB,QAApC;EACA,OAAOH,IAAP;AACD;;AAEDI,kBAAef,QAAf","names":["evalTypeFn","interval","samplers_1","builtIn","computeEndpoints","scale","d","range","Infinity","start","Math","max","domain","end","min","evaluate","chart","meta","xScale","evalFn","sampler","nSamples","globals_1","MAX_ITERATIONS","DEFAULT_ITERATIONS","width","data","emit","index","isHelper","exports"],"sources":["../src/evaluate.ts"],"sourcesContent":[null]},"metadata":{},"sourceType":"script"}